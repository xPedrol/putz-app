<form [formGroup]="uploadForm">
  <div class="row mt-3">
    <div class="mb-3 col-12 col-sm-6 col-lg-3">
      <label class="label">País</label>
      <nb-form-field>
        <nb-select #select size="large" formControlName="country">
          <nb-option *ngFor="let countryCode of countryCodes"
                     [value]="countryCode.dial_code">{{countryCode.name}}</nb-option>
        </nb-select>
      </nb-form-field>
      <ng-container *ngIf="uploadForm.get('country')!.invalid && uploadForm.get('country')!.touched">
        <small class="text-danger d-block" *ngIf="uploadForm.get('country')!.errors?.required">
          Campo obrigatório
        </small>
        <small class="text-danger d-block" *ngIf="uploadForm.get('country')!.errors?.apiValidation">
          {{ uploadForm.get('country')!.errors?.apiValidation}}
        </small>
      </ng-container>
    </div>
    <div class="mb-3 col-12 col-sm-6 col-lg-3">
      <label class="label">
        <nb-icon nbPrefix icon="phone-call-outline" status="success"></nb-icon>
        Whatsapp <span class="text-danger">
        *
      </span></label>
      <nb-form-field>
        <input type="tel" status="success" nbInput fullWidth placeholder="Número de celular" formControlName="whatsapp"
               fieldSize="large" [mask]="countryMasks[selectedCountry?.code]"
               [status]="(uploadForm.get('whatsapp')!.dirty || uploadForm.get('whatsapp')!.touched) ? (uploadForm.get('whatsapp')!.invalid  ? 'danger' : 'success') : 'basic'">
      </nb-form-field>
      <ng-container *ngIf="uploadForm.get('whatsapp')!.invalid && uploadForm.get('whatsapp')!.touched">
        <small class="text-danger d-block" *ngIf="uploadForm.get('whatsapp')!.errors?.required">
          Campo obrigatório
        </small>
        <small class="text-danger d-block" *ngIf="uploadForm.get('whatsapp')!.errors?.apiValidation">
          {{ uploadForm.get('whatsapp')!.errors?.apiValidation}}
        </small>
      </ng-container>
    </div>
    <div class="mb-3 col-12 col-sm-6 col-lg-3">
      <label class="label">Nome</label>
      <nb-form-field>
        <input fullWidth placeholder="Primeiro nome" formControlName="name"
               fieldSize="large"
               [status]="(uploadForm.get('name')!.dirty || uploadForm.get('name')!.touched) ? (uploadForm.get('name')!.invalid  ? 'danger' : 'success') : 'basic'"
               nbInput
               type="text"
               [nbAutocomplete]="nameAutoComplete"/>
        <nb-icon
          nbTooltip="Os nomes escritos na listagem possuem narração. Mas não se preocupe, não tem problema caso seu nome não esteja na lista, ele só não será narrado"
          nbSuffix icon="info-outline"></nb-icon>
        <nb-autocomplete #nameAutoComplete>

          <nb-option *ngFor="let option of validatedNames" [value]="option">
            {{ option }}
          </nb-option>

        </nb-autocomplete>
      </nb-form-field>
      <ng-container *ngIf="uploadForm.get('name')!.invalid && uploadForm.get('name')!.touched">
        <small class="text-danger d-block" *ngIf="uploadForm.get('name')!.errors?.required">
          Campo obrigatório
        </small>
        <small class="text-danger d-block" *ngIf="uploadForm.get('name')!.errors?.apiValidation">
          {{ uploadForm.get('name')!.errors?.apiValidation}}
        </small>
      </ng-container>
    </div>
    <div class="mb-3 col-12 col-sm-6 col-lg-1">
      <label class="label">UF</label>
      <nb-form-field>
        <nb-select fullWidth placeholder="Estado" formControlName="uf" size="large" (selectedChange)="uFChange()"
                   [status]="(uploadForm.get('uf')!.dirty || uploadForm.get('uf')!.touched) ? (uploadForm.get('uf')!.invalid  ? 'danger' : 'success') : 'basic'">
          <nb-option [value]="uf" *ngFor="let uf of ufs">{{uf}}</nb-option>
        </nb-select>
      </nb-form-field>
      <ng-container *ngIf="uploadForm.get('uf')!.invalid && uploadForm.get('uf')!.touched">
        <small class="text-danger d-block" *ngIf="uploadForm.get('uf')!.errors?.required">
          Campo obrigatório
        </small>
        <small class="text-danger d-block" *ngIf="uploadForm.get('uf')!.errors?.apiValidation">
          {{ uploadForm.get('uf')!.errors?.apiValidation}}
        </small>
      </ng-container>
    </div>
    <div class="mb-3 col-12 col-sm-6 col-lg-2">
      <label class="label">Cidade</label>
      <nb-form-field>
        <input fullWidth
               nbInput
               fieldSize="large"
               type="text"
               [status]="(uploadForm.get('city')!.dirty || uploadForm.get('city')!.touched) ? (uploadForm.get('city')!.invalid  ? 'danger' : 'success') : 'basic'"
               formControlName="city"
               placeholder="Digite o nome de uma cidade..."
               [nbAutocomplete]="auto">

        <nb-autocomplete #auto>

          <nb-option *ngFor="let county of counties" [value]="county?.nome">
            {{ county?.nome }}
          </nb-option>

        </nb-autocomplete>
      </nb-form-field>
      <ng-container *ngIf="uploadForm.get('city')!.invalid && uploadForm.get('city')!.touched">
        <small class="text-danger d-block" *ngIf="uploadForm.get('city')!.errors?.required">
          Campo obrigatório
        </small>
        <small class="text-danger d-block" *ngIf="uploadForm.get('city')!.errors?.apiValidation">
          {{ uploadForm.get('city')!.errors?.apiValidation}}
        </small>
      </ng-container>
    </div>
    <div class="mb-3 col-12 col-sm-6 col-lg-2">
      <label class="label">Motivo</label>
      <nb-form-field>
        <nb-select fullWidth placeholder="Selecione um motivo" formControlName="reason" size="large"
                   [status]="(uploadForm.get('reason')!.dirty || uploadForm.get('reason')!.touched) ? (uploadForm.get('reason')!.invalid  ? 'danger' : 'success') : 'basic'">
          <nb-option [value]="'VIAGEM'">Viagem</nb-option>
          <nb-option [value]="'ESTUDO'">Estudo</nb-option>
          <!--                  <nb-option [value]="lg" *ngFor="let lg of languages">{{lg}}</nb-option>-->
        </nb-select>
      </nb-form-field>
      <ng-container *ngIf="uploadForm.get('reason')!.invalid && uploadForm.get('reason')!.touched">
        <small class="text-danger d-block" *ngIf="uploadForm.get('reason')!.errors?.required">
          Campo obrigatório
        </small>
        <small class="text-danger d-block" *ngIf="uploadForm.get('reason')!.errors?.apiValidation">
          {{ uploadForm.get('reason')!.errors?.apiValidation}}
        </small>
      </ng-container>
    </div>
    <div class="mb-3 col-12 col-sm-6 col-lg-2">
      <label class="label">Garantia</label>
      <nb-form-field>
        <nb-select fullWidth placeholder="Selecione uma garantia" formControlName="warranty" size="large"
                   [status]="(uploadForm.get('warranty')!.dirty || uploadForm.get('warranty')!.touched) ? (uploadForm.get('warranty')!.invalid  ? 'danger' : 'success') : 'basic'">
          <nb-option [value]="'IMOVEL'">Imóvel</nb-option>
          <nb-option [value]="'VEICULO'">Veículo</nb-option>
          <!--                  <nb-option [value]="lg" *ngFor="let lg of languages">{{lg}}</nb-option>-->
        </nb-select>
      </nb-form-field>
      <ng-container *ngIf="uploadForm.get('warranty')!.invalid && uploadForm.get('warranty')!.touched">
        <small class="text-danger d-block" *ngIf="uploadForm.get('warranty')!.errors?.required">
          Campo obrigatório
        </small>
        <small class="text-danger d-block" *ngIf="uploadForm.get('warranty')!.errors?.apiValidation">
          {{ uploadForm.get('warranty')!.errors?.apiValidation}}
        </small>
      </ng-container>
    </div>
    <div class="mb-3 col-12 col-sm-6 col-lg-2">
      <label class="label">Dia Pagamento</label>
      <nb-form-field>
        <nb-select fullWidth placeholder="Dt. Pagamento" formControlName="date" size="large"
                   [status]="(uploadForm.get('date')!.dirty || uploadForm.get('date')!.touched) ? (uploadForm.get('date')!.invalid  ? 'danger' : 'success') : 'basic'">
          <nb-option [value]="1">1</nb-option>
          <nb-option [value]="5">5</nb-option>
          <nb-option [value]="10">10</nb-option>
          <nb-option [value]="15">15</nb-option>
          <nb-option [value]="20">20</nb-option>
          <nb-option [value]="25">25</nb-option>
        </nb-select>
      </nb-form-field>
      <ng-container *ngIf="uploadForm.get('date')!.invalid && uploadForm.get('date')!.touched">
        <small class="text-danger d-block" *ngIf="uploadForm.get('date')!.errors?.required">
          Campo obrigatório
        </small>
        <small class="text-danger d-block" *ngIf="uploadForm.get('date')!.errors?.apiValidation">
          {{ uploadForm.get('date')!.errors?.apiValidation}}
        </small>
      </ng-container>
    </div>
    <div class="mb-3 col-12 col-sm-6 col-lg-2">
      <label class="label">Empréstimo</label>
      <nb-form-field>
        <span nbPrefix>R$</span>
        <input type="text" nbInput fullWidth placeholder="Valor do empréstimo ($)" formControlName="loanValue"
               fieldSize="large"
               [status]="(uploadForm.get('loanValue')!.dirty || uploadForm.get('loanValue')!.touched) ? (uploadForm.get('loanValue')!.invalid  ? 'danger' : 'success') : 'basic'">
      </nb-form-field>
      <ng-container *ngIf="uploadForm.get('loanValue')!.invalid && uploadForm.get('loanValue')!.touched">
        <small class="text-danger d-block" *ngIf="uploadForm.get('loanValue')!.errors?.required">
          Campo obrigatório
        </small>
        <small class="text-danger d-block" *ngIf="uploadForm.get('loanValue')!.errors?.apiValidation">
          {{ uploadForm.get('loanValue')!.errors?.apiValidation}}
        </small>
      </ng-container>
    </div>
    <div class="mb-3 col-12 col-sm-6 col-lg-2">
      <label class="label">Taxa</label>
      <nb-form-field>
        <input type="text" nbInput fullWidth placeholder="Taxa de Juros ($)" formControlName="rate"
               fieldSize="large"
               [status]="(uploadForm.get('rate')!.dirty || uploadForm.get('rate')!.touched) ? (uploadForm.get('rate')!.invalid  ? 'danger' : 'success') : 'basic'">
      </nb-form-field>
      <ng-container *ngIf="uploadForm.get('rate')!.invalid && uploadForm.get('rate')!.touched">
        <small class="text-danger d-block" *ngIf="uploadForm.get('rate')!.errors?.required">
          Campo obrigatório
        </small>
        <small class="text-danger d-block" *ngIf="uploadForm.get('rate')!.errors?.apiValidation">
          {{ uploadForm.get('rate')!.errors?.apiValidation}}
        </small>
      </ng-container>
    </div>
    <div class="mb-3 col-12 col-sm-6 col-lg-2">
      <label class="label">Parcela</label>
      <nb-form-field>
        <span nbPrefix>R$</span>
        <input type="text" nbInput fullWidth placeholder="Valor da parcela ($)" formControlName="portionValue"
               fieldSize="large"
               [status]="(uploadForm.get('portionValue')!.dirty || uploadForm.get('portionValue')!.touched) ? (uploadForm.get('portionValue')!.invalid  ? 'danger' : 'success') : 'basic'">
      </nb-form-field>
      <ng-container *ngIf="uploadForm.get('portionValue')!.invalid && uploadForm.get('portionValue')!.touched">
        <small class="text-danger d-block" *ngIf="uploadForm.get('portionValue')!.errors?.required">
          Campo obrigatório
        </small>
        <small class="text-danger d-block" *ngIf="uploadForm.get('portionValue')!.errors?.apiValidation">
          {{ uploadForm.get('portionValue')!.errors?.apiValidation}}
        </small>
      </ng-container>
    </div>
  </div>
</form>
